(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[21],{"V/Pb":function(e,t,a){"use strict";a.r(t);a("ssvk");var n,r,i,l,o,s,c,d=a("Qo4C"),u=(a("GWAV"),a("7YyU")),p=(a("cZcT"),a("T+5x")),h=(a("KbV2"),a("I+kI")),m=(a("4WAF"),a("Qfhr")),f=(a("PCp+"),a("HnZV")),g=a("mK77"),v=a.n(g),y=a("43Yg"),w=a.n(y),S=a("/tCh"),b=a.n(S),k=a("scpF"),I=a.n(k),V=a("O/V9"),E=a.n(V),A=a("8aBX"),C=a.n(A),K=(a("RmDK"),a("/6XP")),N=(a("YyIT"),a("2pDd")),R=a("uqIC"),O=a.n(R),M=a("LneV"),D=a("nNTM"),F=a.n(D),T=a("zHco"),j=a("MMK4"),W=a("34ay"),z=(a("wl+T"),a("zCXI")),x=(a("sjGl"),a("DAkq")),H=a("rXjv"),P=a.n(H),L=(a("Z3A/"),a("pB2J")),B=(n=Object(M["connect"])(function(e){var t=e.wsdlModel,a=e.loading;return{wsdlModel:t,loading:a.models.wsdlModel}}),n((i=function(e){function t(){var e,a;w()(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return a=I()(this,(e=E()(t)).call.apply(e,[this].concat(r))),a.state={targetKeys:[],selectedKeys:[],oriSelectedArray:[],modalVisible:!1},a.componentDidMount=function(){var e=a.props.modalVisible;a.setState({modalVisible:e})},a.okHandle=function(){var e=a.state.targetKeys,t=a.props,n=t.dispatch,r=t.selectedRow,i=t.keyName,l=t.wsdlId,o=a.state.oriSelectedArray,s=[];o.forEach(function(t){var a=e.find(function(e){return e===t[i]});a&&s.push(t.apiId)}),e.forEach(function(e){var t=o.find(function(t){return t[i]===e});t||s.push(e)});var c=r.appkey,d={data:{info:{wsdlId:l,appkey:c,apiIds:s}}};n({type:"wsdlModel/saveAuth",payload:d,callback:function(e){if("200"===e.code){var t=e.msg||"success.",n=a.props,r=n.onVisible,i=n.onRefreshData;r(null,!1),i(),L["a"].success(t)}else{var l=e.msg||"\u670d\u52a1\u5668\u5185\u90e8\u9519\u8bef\u3002";L["a"].error(l)}}})},a.cancelHandle=function(){var e=a.props.onVisible;e(null,!1)},a.handleChange=function(e){a.setState({targetKeys:e})},a.handleSelectChange=function(e,t){a.setState({selectedKeys:[].concat(P()(e),P()(t))})},a.setKey=function(e){var t=a.props.keyName;return e[t]},a}return C()(t,e),b()(t,[{key:"componentWillReceiveProps",value:function(e){var t=this.props.modalVisible,a=e.modalVisible,n=e.selectedRow;if(a!==t&&this.setState({modalVisible:a}),console.log("selectedRow:",n),a!==t){var r=this.props.relationName,i=n&&n[r]?n[r]:[],l=i.map(function(e){return e.apiId});console.log("oriSelectedArray123:",i),this.setState({targetKeys:l,oriSelectedArray:i})}}},{key:"render",value:function(){var e=this,t=this.props,a=t.apiServices,n=t.title,r=this.state,i=r.targetKeys,l=r.selectedKeys,o=r.modalVisible;return O.a.createElement(z["a"],{title:n,visible:o,onOk:function(){return e.okHandle()},onCancel:function(){return e.cancelHandle()},width:700},O.a.createElement(x["a"],{showSearch:!0,rowKey:this.setKey,dataSource:a,titles:["\u672a\u9009\u62e9","\u5df2\u9009\u62e9"],targetKeys:i,selectedKeys:l,onChange:this.handleChange,onSelectChange:this.handleSelectChange,onScroll:this.handleScroll,render:function(e){return"".concat(e.apiId,"-").concat(e.name)},listStyle:{width:300,height:300}}))}}]),t}(R["PureComponent"]),r=i))||r),X=B,J=N["a"].Item,Y=K["a"].Option,Z=function(e){return Object.keys(e).map(function(t){return e[t]}).join(",")},q=(l=Object(M["connect"])(function(e){var t=e.wsdlModel,a=e.loading;return{wsdlModel:t,loading:a.models.wsdlModel}}),o=N["a"].create(),l(s=o((c=function(e){function t(){var e,a;w()(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return a=I()(this,(e=E()(t)).call.apply(e,[this].concat(r))),a.state={wsdlId:null,pagination:{},apiServices:[],records:[],selectedRow:{},modalVisible:!1,filtersArg:{},sorter:{}},a.getWsdl=function(e){var t=a.props.dispatch;a.setState({wsdlId:e});var n={data:{}};n.data.info={wsdlId:e,pageNo:1,pageSize:10},t({type:"wsdlModel/authDetail",payload:n,callback:function(e){var t=e.data,n=t.apiServices,r=t.authOrgs,i=r.records,l=r.pagination;a.setState({pagination:l,apiServices:n,records:i})}})},a.getOptionWhithList=function(e){return!e||e.length<1?O.a.createElement(Y,{key:0,value:0},"\u6ca1\u6709\u627e\u5230\u9009\u9879"):e.map(function(e){return O.a.createElement(Y,{key:e.itemCode,value:e.itemCode},e.itemValue)})},a.conversionFilter=function(e){return Object.keys(e).reduce(function(t,a){var n=v()({},t);return n[a]=Z(e[a]),n},{})},a.handleSearch=function(e){e.preventDefault();var t=a.props,n=t.dispatch,r=t.form;r.validateFields(function(e,t){if(!e){var r=v()({},t);a.setState({formValues:r});var i=a.state,l=i.filtersArg,o=i.sorter,s=i.wsdlId,c=a.conversionFilter(l),d={data:{info:v()({wsdlId:s,pageNo:1,pageSize:10},c,r,o)}};n({type:"wsdlModel/authDetail",payload:d,callback:function(e){var t=e.data,n=t.apiServices,r=t.authOrgs,i=r.records,l=r.pagination;a.setState({pagination:l,apiServices:n,records:i})}})}})},a.handleFormReset=function(){var e=a.props.form,t=a.state.wsdlId;e.resetFields(),a.setState({formValues:{}}),a.getWsdl(t)},a.handleTableChange=function(e,t,n){var r=a.props.dispatch,i=a.state,l=i.formValues,o=i.wsdlId;a.setState({pagination:e,filtersArg:t,sorter:n});var s=a.conversionFilter(t),c=Object(W["g"])(),d={userId:c,data:{info:v()({wsdlId:o,pageNo:e&&e.current?e.current:1,pageSize:e&&e.pageSize?e.pageSize:10},l,s,n)}};n.field&&(d.data.info.sorter="".concat(n.field,"_").concat(n.order)),r({type:"wsdlModel/authDetail",payload:d,callback:function(e){var t=e.data,n=t.apiServices,r=t.authOrgs,i=r.records,l=r.pagination;a.setState({pagination:l,apiServices:n,records:i})}})},a.handleVisible=function(e,t){a.setState({modalVisible:t,selectedRow:e})},a.handleRefreshData=function(){var e=a.state,t=e.pagination,n=e.filtersArg,r=e.sorter;a.handleTableChange(t,n,r)},a.handleAccess=function(e){a.handleVisible(e,!0)},a}return C()(t,e),b()(t,[{key:"componentDidMount",value:function(){var e=this.props.location,t=e.state;console.log("location state:",t);var a=t||{wsdlId:105},n=a.wsdlId;this.getWsdl(n)}},{key:"getOption",value:function(e,t){var a=Object(j["d"])(e,t);return this.getOptionWhithList(a)}},{key:"renderForm",value:function(){var e=this.props.form.getFieldDecorator;return O.a.createElement(N["a"],{onSubmit:this.handleSearch,layout:"inline"},O.a.createElement(p["a"],{gutter:{md:8,lg:24,xl:48}},O.a.createElement(m["a"],{md:8,sm:24},O.a.createElement(J,{label:"orgName"},e("orgName")(O.a.createElement(f["a"],{placeholder:"please enter orgName"})))),O.a.createElement(m["a"],{md:8,sm:24},O.a.createElement(J,{label:"status"},e("wsdlAuthType",{})(O.a.createElement(K["a"],{placeholder:"please choose",style:{width:"100%"}},this.getOption("wsdl","wsdlAuthType"))))),O.a.createElement(m["a"],{md:8,sm:24},O.a.createElement("span",{className:F.a.submitButtons},O.a.createElement(h["a"],{type:"primary",htmlType:"submit"},"\u67e5\u8be2"),O.a.createElement(h["a"],{style:{marginLeft:8},onClick:this.handleFormReset,htmlType:"button"},"\u91cd\u7f6e")))))}},{key:"render",value:function(){var e=this,t=[{title:"id",dataIndex:"id"},{title:"orgName",dataIndex:"orgName"},{title:"appkey",dataIndex:"appkey"},{title:"authRatio",dataIndex:"authRatio"},{title:"Action",key:"action",render:function(t,a){return O.a.createElement("span",null,O.a.createElement("a",{onClick:function(){return e.handleAccess(a,!0)}},"Access"))}}],a=this.state,n=a.pagination,r=a.apiServices,i=a.records,l=a.selectedRow,o=a.modalVisible,s=a.wsdlId,c=this.props,p=c.loading,h=c.location,m="",f=h.state,g=f||{},v=g.record,y=v.wsdlName;return O.a.createElement(T["a"],{onBack:function(){return window.history.back()},style:{height:"50px"},title:"Wsdl Auth\uff1a\uff08".concat(y,"\uff09")},O.a.createElement(d["a"],{bordered:!1},O.a.createElement("div",{className:F.a.tableListForm},this.renderForm()),O.a.createElement(u["a"],{rowKey:m||"key",loading:p,size:"small",columns:t,dataSource:i,pagination:n,onChange:this.handleTableChange}),O.a.createElement(X,{title:"Access Api",modalVisible:o,onVisible:this.handleVisible,selectedRow:l,onRefreshData:this.handleRefreshData,keyName:"apiId",apiServices:r,relationName:"apiServices",wsdlId:s})))}}]),t}(R["PureComponent"]),s=c))||s)||s);t["default"]=q}}]);